<section class="text-gray-600 dark:bg-slate-950 dark:text-gray-200 body-font pt-3">
  <button [routerLink]="['/login']" type="button" class="absolute left ml-3 mt-3 w-full flex items-center justify-center w-1/2 px-5 py-2 text-sm text-gray-700 transition-colors duration-200 bg-white border rounded-lg gap-x-2 sm:w-auto dark:hover:bg-gray-800 dark:bg-gray-900 hover:bg-gray-100 dark:text-gray-200 dark:border-gray-700">
    <svg class="w-5 h-5 rtl:rotate-180" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
      <path stroke-linecap="round" stroke-linejoin="round" d="M6.75 15.75L3 12m0 0l3.75-3.75M3 12h18" />
    </svg>
    <span>Voltar</span>
  </button>
  <app-toggle-dark-mode class="w-1/12 absolute right-0 mr-3 mt-3"></app-toggle-dark-mode>
    <div class="fundo mt-10 sm:mx-auto sm:w-full sm:max-w-2xl bg-gray-100 dark:bg-slate-800 rounded-lg p-5 overflow-auto">

      @if (spinnerCEP){
        <div class="overlay">
          <div class="spinner"></div>
        </div>
      }

      <mat-stepper #stepper>
        <mat-step>
          <form [formGroup]="formAccount">
            <ng-template matStepLabel> <span class="text-black dark:text-white">Conta</span> </ng-template>
            <div>
              <label for="name" class="text-gray-900 dark:text-gray-200 text-lg font-medium title-font mb-5">Nome*</label>
              <div class="mt-2">
                <input id="name" formControlName="name" name="name" type="text" autocomplete="name" required class="w-full bg-white dark:bg-slate-900 rounded border border-gray-300 dark:border-slate-500 focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200 text-base outline-none text-gray-700 dark:text-gray-200 py-1 px-3 leading-8 transition-colors duration-200 ease-in-out" />
                @if (validatorFormField(formAccount, 'name')){
                  <span class="text-red-500 text-xs">{{ formAccount.get('name').errors['required'] ? 'Campo obrigatório' : 'Invalido'  }}</span>
                }
              </div>
            </div>

            <div class="flex">
              <div class="w-1/2 mx-1">
                <label for="cpf" class="text-gray-900 dark:text-gray-200 text-lg font-medium title-font mb-5">CPF*</label>
                <div class="mt-2">
                  <input id="cpf" formControlName="cpf" name="cpf" type="text" autocomplete="cpf" required class="w-full bg-white dark:bg-slate-900 rounded border border-gray-300 dark:border-slate-500 focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200 text-base outline-none text-gray-700 dark:text-gray-200 py-1 px-3 leading-8 transition-colors duration-200 ease-in-out" />
                  @if (validatorFormField(formAccount, 'cpf')){
                    <span class="text-red-500 text-xs">{{ formAccount.get('cpf').errors['required'] ? 'Campo obrigatório' : 'Invalido'  }}</span>
                  }
                </div>
              </div>
              <div class="w-1/2 mx-1">
                <label for="phone" class="text-gray-900 dark:text-gray-200 text-lg font-medium title-font mb-5">Telefone*</label>
                <div class="mt-2">
                  <input id="phone" formControlName="phone" name="phone" type="text" autocomplete="phone" required class="w-full bg-white dark:bg-slate-900 rounded border border-gray-300 dark:border-slate-500 focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200 text-base outline-none text-gray-700 dark:text-gray-200 py-1 px-3 leading-8 transition-colors duration-200 ease-in-out" />
                  @if (validatorFormField(formAccount, 'phone')){
                    <span class="text-red-500 text-xs">{{ formAccount.get('phone').errors['required'] ? 'Campo obrigatório' : 'Invalido'  }}</span>
                  }
                </div>
              </div>
            </div>


            <div class="w-full mx-1">
              <label for="email" class="text-gray-900 dark:text-gray-200 text-lg font-medium title-font mb-5">Email*</label>
              <div class="mt-2">
                <input id="email" formControlName="email" name="email" type="email" autocomplete="email" required class="w-full bg-white dark:bg-slate-900 rounded border border-gray-300 dark:border-slate-500 focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200 text-base outline-none text-gray-700 dark:text-gray-200 py-1 px-3 leading-8 transition-colors duration-200 ease-in-out" />
                @if (validatorFormField(formAccount, 'email')){
                  <span class="text-red-500 text-xs">{{ formAccount.get('email').errors['required'] ? 'Campo obrigatório' : 'Email inválido'  }}</span>
                }
              </div>
            </div>
            <div class="w-full mx-1">
              <label for="password" class="text-gray-900 dark:text-gray-200 text-lg font-medium title-font mb-5">Senha*</label>
              <div class="mt-2">
                <input id="password" formControlName="password" name="password" [type]="inputPasswordType" autocomplete="current-password" required class="w-full bg-white dark:bg-slate-900 rounded border border-gray-300 dark:border-slate-500 focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200 text-base outline-none text-gray-700 dark:text-gray-200 py-1 px-3 leading-8 transition-colors duration-200 ease-in-out" />
                @if (validatorFormField(formAccount, 'password')){
                  <span class="text-red-500 text-xs">{{ formAccount.get('password').errors['required'] ? 'Campo obrigatório' : 'Senha inválida'  }}</span>
                }
              </div>
              <div class="mt-2 flex items-center">
                <input id="showPassword" type="checkbox" (change)="showPassword()" class="w-4 h-4 mr-2" />
                <label for="showPassword" class="text-gray-900 dark:text-gray-200 text-sm font-medium title-font">Mostrar senha</label>
              </div>
            </div>


            <div>
              <button matStepperNext class="mt-5 bg-indigo-600 hover:bg-blue-700 text-white py-2 px-4 rounded">
                Ir para endereço
              </button>
            </div>
          </form>
        </mat-step>

        <mat-step>
          <form [formGroup]="formAddress">
            <ng-template matStepLabel><span class="text-black dark:text-white">Endereço</span></ng-template>
            <div class="w-full mx-1">
              <label for="cep" class="text-gray-900 dark:text-gray-200 text-lg font-medium title-font mb-5">CEP*</label>
              <div class="mt-2">
                <input id="cep" formControlName="cep" name="cep" type="text" autocomplete="cep" required class="w-full bg-white dark:bg-slate-900 rounded border border-gray-300 dark:border-slate-500 focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200 text-base outline-none text-gray-700 dark:text-gray-200 py-1 px-3 leading-8 transition-colors duration-200 ease-in-out" />
                @if (validatorFormField(formAddress, 'cep')){
                  <span class="text-red-500 text-xs">{{ formAddress.get('cep').errors['required'] ? 'Campo obrigatório' : 'Digite um cep válido'  }}</span>
                }
              </div>
            </div>

            <div class="flex">
              <div class="w-1/2 mx-1">
                <label for="number" class="text-gray-900 dark:text-gray-200 text-lg font-medium title-font mb-5">Numero*</label>
                <div class="mt-2">
                  <input id="number" formControlName="number" name="number" type="number" autocomplete="number" required class="w-full bg-white dark:bg-slate-900 rounded border border-gray-300 dark:border-slate-500 focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200 text-base outline-none text-gray-700 dark:text-gray-200 py-1 px-3 leading-8 transition-colors duration-200 ease-in-out" />
                  @if (validatorFormField(formAddress, 'number')){
                    <span class="text-red-500 text-xs">{{ formAddress.get('number').errors['required'] ? 'Campo obrigatório' : 'Inválido'  }}</span>
                  }
                </div>
              </div>
              <div class="w-1/2 mx-1">
                <label for="address" class="text-gray-900 dark:text-gray-200 text-lg font-medium title-font mb-5">Rua*</label>
                <div class="mt-2">
                  <input id="address" formControlName="address" name="address" type="text" autocomplete="address" required class="w-full bg-white dark:bg-slate-900 rounded border border-gray-300 dark:border-slate-500 focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200 text-base outline-none text-gray-700 dark:text-gray-200 py-1 px-3 leading-8 transition-colors duration-200 ease-in-out" />
                  @if (validatorFormField(formAddress, 'address')){
                    <span class="text-red-500 text-xs">{{ formAddress.get('address').errors['required'] ? 'Campo obrigatório' : 'Invalido'  }}</span>
                  }
                </div>
              </div>
            </div>

            <div class="flex">
              <div class="w-1/2 mx-1">
                <label for="city" class="text-gray-900 dark:text-gray-200 text-lg font-medium title-font mb-5">Cidade*</label>
                <div class="mt-2">
                  <input id="city" formControlName="city" name="city" type="text" autocomplete="city" required class="w-full bg-white dark:bg-slate-900 rounded border border-gray-300 dark:border-slate-500 focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200 text-base outline-none text-gray-700 dark:text-gray-200 py-1 px-3 leading-8 transition-colors duration-200 ease-in-out" />
                  @if (validatorFormField(formAddress, 'city')){
                    <span class="text-red-500 text-xs">{{ formAddress.get('city').errors['required'] ? 'Campo obrigatório' : 'Invalido'  }}</span>
                  }
                </div>
              </div>
              <div class="w-1/2 mx-1">
                <label for="state" class="text-gray-900 dark:text-gray-200 text-lg font-medium title-font mb-5">Estado*</label>
                <div class="mt-2">
                  <input id="state" formControlName="state" name="state" type="text" autocomplete="state" required class="w-full bg-white dark:bg-slate-900 rounded border border-gray-300 dark:border-slate-500 focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200 text-base outline-none text-gray-700 dark:text-gray-200 py-1 px-3 leading-8 transition-colors duration-200 ease-in-out" />
                  @if (validatorFormField(formAddress, 'state')){
                    <span class="text-red-500 text-xs">{{ formAddress.get('state').errors['required'] ? 'Campo obrigatório' : 'Invalido'  }}</span>
                  }
                </div>
              </div>
            </div>

            <div class="flex justify-between items-center">
              <button matStepperPrevious class="mt-1 bg-red-700 hover:bg-red-800 text-white py-2 px-4 rounded">
                Voltar para conta
              </button>

              <button matStepperNext class="mt-5 bg-indigo-600 hover:bg-blue-700 text-white py-2 px-4 rounded">
                Finalizar
              </button>
            </div>
          </form>

        </mat-step>
        <mat-step>
          <ng-template matStepLabel><span class="text-black dark:text-white">Finalizar</span> </ng-template>
          <h1 class="text-center dark:text-gray-100">Confira seus dados abaixo</h1>

          <div class="flex flex-col dark:text-gray-100">
            <div class="p-5 mt-3">
              <h2 class="text-lg">Conta</h2>
              <hr>
              <p class="my-2">Nome: {{ formAccount.get('name').value ?? '???'}}</p>
              <p class="my-2">CPF: {{ formAccount.get('cpf').value ?? '???' }}</p>
              <p class="my-2">Telefone: {{ formAccount.get('phone').value ?? '???'}}</p>
              <p class="my-2">Email: {{ formAccount.get('email').value ?? '???'}}</p>
            </div>
            <div class="p-5 mt-3">
              <h2 class="text-lg font-bold">Endereço</h2>
              <hr>
              <p class="my-2">CEP: {{ formAddress.get('cep').value ?? '???' }}</p>
              <p class="my-2">Rua: {{ formAddress.get('address').value ?? '???'}}</p>
              <p class="my-2">Numero: {{ formAddress.get('number').value ?? '???' }}</p>
              <p class="my-2">Cidade: {{ formAddress.get('city').value ?? '???' }}</p>
              <p class="my-2">Estado: {{ formAddress.get('state').value ?? '???' }}</p>
            </div>
          </div>

          @if (!formAccount.valid){
            <h2 class="my-5 text-red-500 font-bold text-center">Preencha todos os campos obrigatórios de Conta</h2>
          }

          @if (!formAddress.valid){
            <h2 class="my-5 text-red-500 font-bold text-center">Preencha todos os campos obrigatórios de Endereço</h2>
          }

          @if (formAddress.valid && formAccount.valid){
            <h2 class="my-5 text-green-500 font-bold text-center">Formulário validado com suceeso! Finalize seu cadastro no botão "Cadastrar"</h2>
          }


          <div class="flex items-center justify-between">
            <button matStepperPrevious class="mt-1 bg-red-700 hover:bg-red-800 text-white py-2 px-4 rounded">
              Voltar para endereço
            </button>

            <button (click)="register()" [disabled]="formAccount.invalid || formAddress.invalid" class="mt-5 bg-indigo-600 hover:bg-blue-700 text-white py-2 px-4 rounded disabled:bg-indigo-200">
              Cadastrar
            </button>
          </div>
        </mat-step>
      </mat-stepper>
    </div>
</section>
